<script type="text/javascript">
<!--

/**
 * Split an array in chunks of equal size
 * 
 */
 Array.prototype.chunk = function(chunkSize) {
    var array=this;
    return [].concat.apply([],
        array.map(function(elem,i) {
            return i%chunkSize ? [] : [array.slice(i,i+chunkSize)];
        })
    );
};

/**
 * Define the pseudo language for the openEssayist keywords, as used by HighlightJS
 * @see HighlightJS
 */
hljs.LANGUAGES['openessay'] = function(hljs) {

	// define the formatters, based on pattern matching
	var formatters = [];
	
	{% for item in ngrams[0:] %}
		{% set kw = item.kw %}
		{% set id = item.id %}
		{% for ss in kw %}
			formatters.push({
				className: "ngram {{ id }}",
				dataContent: "data-keyword='1'",
			{% if (ss.ngram|length) == 1 %}
				beginWithKeyword: true, 
				keywords: '{{ ss.source|join(' ') }}',
			{% else %}
				begin: "\\b({{ ss.source|join(')\\\\b\\\\s*\\\\b(') }})\\b",
			    keywords: '{{ ss.source|join(' ') }}',
			{% endif %}
		        relevance: 0
			});
		{% endfor %}
	{% endfor %}
	// return the "language" definition
	return {
		case_insensitive: true,
		contains: formatters
	};
	
}(hljs);


//-->
</script>
